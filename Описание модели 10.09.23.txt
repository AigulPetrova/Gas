Тема диссертационой работы: 
Методы и алгоритмы нейросетевого управления балансом газа 
в газотранспортной сети

Описание модели системы управления балансом газа


Модель системы управления балансом газа
План
Обучить на всех ГРС регрессионную нейросеть 
Обучить классификационную нейросеть для всех ГРС (сейчас есть для одной, Светлогорска, которая оказалась в тестовой выборке) 
Идентифицировать и классифицировать отклонения: 
 для регрессионной нейросети по трем уровням 3-х параметров (величина, длительность, скорость нарастания отклонения), 
 для классификационной нейросети по одному уровня 4-х параметров (вероятность, длительность, скорость нарастания отклонения, и вероятная причина)
Оценить вероятность принадлежности выявленных отклонений исходному закону распределения
По анфису определить небаланс по отклонениям из п.3.
Определить запас, с учетом температуры грунта реальной и неизвестной в СТО температуры Т
Создать виртуальные датчики расходов на собственные нужды, запаса, небаланса, расходов на устранение.
Составить алгоритм принятия решения о мерах устранения в зависимости от причин и оптимизационного фактора
Определить баланс старым и новым методом
Показать эффективность метода сравнением какой был бы баланс(небаланс) и какой стал
Подключить нейросети в газовую и электромодель
Составить передаточные функции и матрицу состояний
Сделать нейросетевой контроллер
Дополнительно (когда будет возможно)
 Влючить обученную на всех ГРС регрессионную нейросеть в нейросеть с двумя выходами
 Перевести на С++, запрограммировать контроллер

   Вероятность возникновения причины небаланса  12345Значимость последствий5  24, 25   45, 13, 152316 , 18  312, 14, 1920, 21, 221, 217 26104 17, 8, 9117 
ПричиныМероприятияУсловия управленияМаленькие величина, длительность или скорость нарастания отклонений предсказаний нейросети на k+1 шаге от реальных данных на k-том шаге1)	Погрешность или отклонения в работе средств измерений (в т.ч. притупление входной кромки диафрагмы в методе перепада давления).
2)	Импульсный режим (для турбинных счетчиков)
3)	Диапазон измерений не по паспорту СИ (для счётчиков)
4)	Местонахождение СИ, улица или помещение
5)	Скачок параметров в нестационарном режиме.
6)	Отсутствие учета при продувках.
7)	Упрощенная линеаризация аналитических выражений расчётных величин
8)	Расчетно-методическая погрешность в расчетах запаса газа
9)	Низкая квалификация персонала, ведущего учет 
10)	Наличие линий связей, влияющих на обмен данными1.	Компенсация за счет расчетно-методической погрешности вычисления запаса газа в магистральном газопроводе;
2.	Плановая поверка средств измерений;
3.	Внеплановая поверка средств измерений;
4.	Проверка действий оператора по подаче давления потребителям;
5.	Проверка и, при необходимости, корректировка расчетов с потребителями; необходимость первоочередного устранения причин, которые могут создавать пожарную и взрывоопасность;
 необходимость выполнения договоров поставок; 
 необходимость выполнения регламентов по затратам на транспортировку;
 минимизация расходов на мероприятия по поддержанию баланса.Средние величина, длительность или скорость нарастания отклонений предсказаний нейросети на k+1 шаге от реальных данных на k-том шаге1)	Изменение температуры точки росы
2)	Несоответствие нормативов потребления реальному потреблению
3)	Разные отчётные периоды, у поставщика и потребителя
4)	Принятие условно постоянных величин для разных групп потребителей.
5)	Технологические потери при обслуживании трубопровода и транспортировке газа.
6)	Повышение коэффициента шероховатости внутри стенок
7)	Негерметичность фланцевых соединений
8)	Механические примеси
9)	Отклонение режимов работы от проектных.6.	Плановая проверка обходчиком наличия свища или микротрещины;
7.	Подача корректирующего давления Pкорр;
8.	Корректирование температуры газа Ткорр;Большие величина, длительность или скорость нарастания отклонений предсказаний нейросети на k+1 шаге от реальных данных на k-том шаге1)	Свищ
2)	Отбор газа без его учета (врезка).
3)	Авария, разрыв.
4)	Погодные условия (резкие скачки параметров)
5)	Регион (температурные нормы)
6)	Размер населенных пунктов. и теплотрасс, влияющих на трубопровод9.	Внеплановая проверка обходчиком наличия крупной утечки;  
10.	Направление вертолета и бригады на устранение крупной утечки;   
11.	Направление комиссии (на проверку попадания в газ влаги или кислорода, наличие врезок).
12.	Применение уставок, прекращение поставок.









ТрубопроводСвойства газаПроцесс измеренияПроцедура учетаОрганизационные факторы Повышение коэффициента шероховатости внутри стенок
 Негерметичность фланцевых соединений
  Изменение точки росы
 Механические примеси
 Скачок параметров в нестационарном режиме. Погрешность или отклонения в работе средств измерений (в т.ч. притупление входной кромки диафрагмы в методе перепада давления).
 Импульсный режим (для турбинных счетчиков)
 Диапазон измерений не по паспорту СИ (для счётчиков)
 Местонахождение СИ, улица или помещение Отсутствие учета при продувках.
 Упрощенная линеаризация аналитических выражений расчётных величин
 Отклонение режимов работы от проектных. 
 Ошибки в расчетах запаса газа Низкая квалификация персонала, ведущего учет 
 Погодные условия (резкие скачки параметров)
 Регион (температурные нормы)
 Размер населенных пунктов. и теплотрасс, влияющих на трубопровод. 
 Наличие линий связей, влияющих на обмен данными
 Несоответствие нормативов потребления реальному потреблению
 Разные отчётные периоды, у поставщика и потребителя
 Принятие условно постоянных величин для разных групп потребителей.
 Технологические потери при обслуживании трубы и транспортировке газа.
 Отбор газа без его учета (врезка).
 Авария, разрыв.

БлокКак получаем функционал блокаДанные на входеРазмерностьДанные на выходеРазмерностьКомпрессорная станцияПока имитируется данными
Есть формула (13-18 ниже по тексту)Давление Pвх
Pвыхкгс/см2Объемный Расход Qтыс. м3/час (при 20 °С)ГРС, ГИСПока имитируется данными
Есть формула (1 ниже по тексту)Давление Pвх
Pвыхкгс/см2Объемный Расход Qтыс. м3/час (при 20 °С)
Виртуальные датчики:ЗапасПока имитируется данными
Есть формула (2 и далее)Давление, температура, к-т сжимаемости или плотностькгс/см2,
гр Цельсия, безрамерныйОбъемный расходтыс. м3/час (при 20 °С)СН – собственные нуждыПока имитируется данными
Есть формула (9 и далее)Тип гпа и дртыс. м3/час (при 20 °С)Объемный расходтыс. м3/час (при 20 °С)НебалансРасчетная на основе данныхОбъемный расход на грс и данные нейросетитыс. м3/час (при 20 °С)Объемный расходтыс. м3/час (при 20 °С)Поддержания балансаРасчетная на основе данныхДавление и стоимость мероприятийДавление или деньгиДавление или деньгикгс/см2 или рубли\

 Получение компонентных уравнений
        Приведенные уравнения можно использовать для описания динамики компонентов системы управления балансом (подсистема поддержания баланса, учёта расхода, расчета запаса). Коэффициенты уравнений соответствуют коэффициентам эмпирических уравнений. 
      Топологическое уравнение или уравнение динамики для ГТС с одной ГРС получается из второго уравнения Кирхгофа для эквивалентной схемы, путем суммирования рассмотренных выше компонент:
m (dQ_1)/dt+?k_грс?Q?_грс+V/B  P_запас+ P??k?_неб=  P_вх			(1)
      В форме Коши 
(dQ_1)/dt=1/m(P_вх-?k_грс?Q?_грс-V/B  P_запас  -?P?k?_( неб ))			(2)
      Выведем упругую компоненту в отдельное уравнение для ее формализации и расчета:
(dQ_1)/dt=1/m(P_вх-V/B  p_запас1-??k_грс1?Q?_грс1- P?k?_( неб1 ))			(3)
(dP_запас1)/dt=V/B  (?Q_грс1- Q_2-Q?_( неб1 ))				(4)
Q_2 – объем, уходящий на следующий контур, то есть на следующую ГРС.
        На основе полученных уравнений построена динамическая структура объекта управления: для ГТС с одной ГРС (Рисунок 3), для ГТС с несколькими ГРС, на примере двух (Рисунок 4), построенные в среде Simintech (Рисунок 5). 

Структурная схема модели управления ГТС с одной ГРС

Структурная схема модели управления ГТС с двумя ГРС

Имитационная модель объекта исследования двухконтурной системы
Подсистема учета расхода газа
Расход газа - количество газа, протекающего через данное сечение в единицу времени, характеризующий пропускную способность и производительность газопроводов, производственную мощность ГТС. Учет объемов поставки и потребления газа производится в единицах объема, приведенных к стандартным условиям: t = 20 °C, p = 101325 Паю. 
 Подсистема учета расхода газа включает в себя: \
 Входные величины: 
давление на входе участка Рвх, (кгс/см2);
температура на входе участка Твх °C
 Выходные величины:
объемный расход газа на участке, тыс. м3/час
 Регулируемые величины 
давление на выходе участка Рвых (кгс/см2);
температура на выходе участка Твых °C
 Величины, влияющие на ход процесса:
внешние воздействия ?, для ТП учета расхода газа, это факторы, характеризующие состояние рабочей среды (газа): ?v, плотность газа, а также состояние трубопровода и средств измерения: коэффициенты шероховатости, перепадов диаметров и др.
Рисунок 6 иллюстрирует процесс учета расхода газа как абстрактный управляемый объект 

Технологический процесс учета расхода газа как объект управления
Формула для учета расхода газа методом переменного перепада давлений с помощью диафрагмы, имеет следующий вид:
Q = (? · d202 / 4) · Ксу 2 · Kш · Kп · C · E · (2 ?p/?v )0,5  		  (5)
Где Q - расход газа, м3;
d20 - диаметр отверстия диафрагмы при температуре 20°С;
Ксу - коэффициент, учитывающий изменение диаметра отверстия диафрагмы, вызванное отклонением температуры природного газа от 20 °С;
Kш и Kп, - коэффициенты шероховатости внутренней поверхности стенки и притупления входной кромки диафрагмы (при использовании других сужающих устройств Kп = 1);
C - коэффициент истечения;
?p - перепад давления на сужающем устройстве, Па;
?v - плотность среды при рабочих условиях;
Е = 1 / (1 - ?4)0,5 - коэффициент скорости входа;
? = d / D - относительный диаметр отверстия сужающего устройства;
d - диаметр отверстия диафрагмы при рабочей температуре;
D - диаметр трубы (Комплекс межгосударственных стандартов ГОСТ 8.586.1-2005 - ГОСТ 8.586.5. -2005 «Измерение расхода и количества жидкостей и газов с помощью стандартных сужающих устройств»)].
Подсистема расчета запаса газа включает в себя:
 Входные величины: 
среднее давление газа в трубопроводе Рср, (кгс/см2);
средняя температура газа в трубопроводе Тср, °C;
средний коэффициент сжимаемости газа в трубопроводе Zср;	
 Выходные величины:
объем запаса газа на участке, Qзап, тыс. м3/час;
 Регулируемые величины: 
объемный расход газа на участке, Q, тыс. м3/час;
 Величины, влияющие на ход процесса:
 ?xa молярная доля азота кг/моль, определяемая по ГОСТ 30319.1;
 ?xy молярная доля диоксида углерода кг/моль, определяемая по ГОСТ 30319.1; 
 ?ст - плотность транспортируемого газа, кг/м3, при стандартных условиях (Рс = 0,1013 МПа и Tc = 293,15 К).
 температура окружающей среды, в которой пролегает труба, в случае подземного пролегания – температура грунта Тгр, °C;

Технологический процесс учета запаса газа в МГ как объект управления
Для оценки запаса газа в трубопроводах в пределах газотранспортного предприятия используется формула: 
Q=?_(j=1)^J?Q_i 						(6)
Где J- число расчетных участков. 
Запас газа на участке многониточной системы магистрального газопровода при стандартных условиях определяется по формуле: 
 Q_(зап i)=V  (P T_c)/(Z T P_c )					(7)
Где Vi – геометрический объем j-й нитки газопровода, м3
Pср-среднее давление j-ой нитки газопровода, кгс/см2;
n- число ниток магистрального газопровода;
zср – средний коэффициент сжимаемости j-ой нитки;
Тср – средняя температура газа j-ой нитки, °C.
Геометрический объем трубы на участке вычисляется по формуле: 
V_i=(?D_(iвн?)^2 l)/4						(8)
где, l, Dвн – соответственно длина и внутренний диаметр нитки магистрального газопровода.
Среднее давление нитки магистрального газопровода, Рср, кгс/см2, определяется по формуле:
Р_iср=2/3?(Р_н+  (Р_к^2)/(Р_н+Р_к ))					(9)
Рн – абсолютное давление газа в начале участка газопровода, кгс/см2
Рк- абсолютное давление газа в конце участка газопровода, кгс/см2
Средняя температура газа на участке магистрального газопровода, °C, определяется по формуле: 
		(10)
Где Тгр – температура грунта на глубине заложения газопровода, обновляется ежемесячно по статистическим данным. В случае, если Тгр выше, чем конечная температура газа, то Тк принимается равной Тгр+1.
Тiн –температура газа в начале i-ой нитки газопровода, °C
Тiк- температура газа в конце i-ой нитки газопровода, °C
Тгр - обновляется ежемесячно по статистическим данным. В случае, если Тгр выше, чем конечная температура газа, то Тк принимается равной Тгр+1.
Усредненное значение коэффициента сжимаемости определяется по формуле:
z_iср=1  0.0907?Р_iср??(Т_iср/200)?^(-3.668)  				(11)
Запас газа в подземных хранилищах газа
Остаточный запас газа в ПХГ, может быть определен объемным методом. Формула для подсчета запасов газа в ПХГ имеет следующий вид
V = F*h*k*K*P/Оr						 (12)
где V- количество газа, находящегося в ПХГ на дату расчета, м3; 
F - площадь в пределах продуктивного контура, м; 
h -мощность пористой части пласта, м; 
k- коэффициент пористости; 
К = (T + tст)/(T + tm) - поправка на температуру для приведения объема газа к стандартной температуре; tст= 20°С; 
tm- пластовая температура; 
Т- абсолютная температура, К; 
Р - среднее абсолютное давление в залежи на дату расче­та, кгс/см2; 
Оr- коэффициент газонасыщенности.
В рассматриваемом Калининградском регионе в 2015 году, за который предоставлены статистические данные, ПХГ не было, оно открылось позже поэтому далее этот элемент ГТС в системе учета расход газа не рассматривается. 
Подсистема поддержания баланса включает в себя:
 управляющие воздействия зависят от корректирующего мероприятия и устройства, для КС это: 
число оборотов нагнетателя, nн, об/мин;
положение заслонки антипомажного клапана АПК, k;
 управляемые переменные:
давление газа Ркорр, на перекачивание корректирующих объемов, кгс/см2;
температуру газа Ткорр, °C;
расходы на мероприятия по поддержанию баланса, Qподд, тыс. м3/час;
 регулируемые переменные:
объемы расхода на собственные нужды Qсн, тыс. м3/час;
объем запаса газа на участке, Qзапас, тыс. м3/час;
объем расхода газа, Qрасх, тыс. м3/час;
объем небаланса в системе, Qнеб, тыс. м3/час;
 величины, влияющие на ход процесса, зависят от корректирующего мероприятия и устройства, для КС это:
давление на входе ГТС, Pвх, кгс/см2;
Н_тг^0- норма расхода топливного газа для ГПА i-го типа, кг у.т./кВт?ч;
объемная производительность компрессора Qоб, млн. м3/сут
внешние воздействия ?, здесь это ta - средняя температура атмосферного воздуха за планируемый период и состояние оборудования: Ку, коэффициент, учитывающий влияние эксплуатации котлов-утилизаторов.

Технологический процесс учета расхода газа на поддержание баланса как абстрактный управляемый объект

Процесс управления балансом газа
Рисунок 9 представляет процесс управления балансом газа как абстрактный управляемый объект. Пояснить или добавить в рисунок 2

Процесс управления балансом газа как абстрактный управляемый объект
Рисунок 9 иллюстрирует процесс, на который оказывают влияние управляющие	 воздействия – заданные давление Рзадан и температура Тзадан среды, и заданный уровень небаланса Qнеб задан, управляемыми переменными являются расходы на собственные нужды Qсн, объёмы запаса Qзапас, и объёмы на поддержание баланса Qподд, и фактический объем небаланса Qнеб. Также на систему оказывают влияние возмущения:  давление на воде ГТС и внешние воздействия  ?, включающие в себя: Токр – температура окружающей среды, Pатм – атмосферное давление, Ктр - состояние трубопровода, Корг - организационные факторы (ошибки операторов, нарушение договоров поставок и процедур учета, незаконный отбор, корректность расчета величин запаса и собственных нужд), ?си – погрешности средств измерения, а также факторы, характеризующие состояние рабочей среды (газа):  компонентный состав Кг, температуру T и коэффициент сжимаемости Z.
Баланс газа в ГТС
В результате выполнения операций по учету расхода и запаса газа происходит формирование баланса газа за отчетный период (сутки, месяц, год). Баланс газа - равенство суммарного объема газа, поставленного в газотранспортную или газораспределительную системы, сумме объемов газа, переданного из этих систем конечным потребителям газа, потребления газа на собственные и технологические нужды организаций, оказывающих услуги по его транспортировке, а также объемов технологических потерь и утраты. В идеале должно быть обеспечено равенство количества поставленного и потреблённого газа. Если равенства не происходит, значит в системе имеет место небаланс. 
Уравнение баланса газа для региональной ГТС:
Qгрс + Qгис = Qпост– Qсн+ Qпхг + Qмг+ Qнебгтс 				(14)
где Qгрс– объем газа, поданный через ГРС потребителям; 
Qгис – газа, направленный через ГИС в принимающую ГТС;
Qпост – поступление газа в газопровод с газовых промыслов и/или из других газотранспортных систем; 
Qпхг – объем запаса в подземных хранилищах газа, млн. м3; 
Qсн – объемный расход газа на собственные нужды, млн. м3; 
Qзап – объемный расход газа на заполнение газопроводов, из чего формируется величина запаса газа в магистральных газопроводах, млн. м3;
Qнебгтс – объем потерь газа, или небаланс, млн. м3.
Для эффективной работы системы транспорта газа необходимо решить задачу оптимизации.
Qнебгтс = (Qпост – (Qгрс + Qгис + Qсн + Qпхг+ Qмг))? min 			(15)
Где целевая функция представляет собой величину небаланса Qнебгтс;
Переменными являются входные и выходные объемы потоков газа: Qпост, Qгрс, Qгис, Qсн, Qпхг, Qмг, которые рассчитываются на основе применяемого метода измерения расхода газа. 
Целью решения задачи оптимизации управления балансом газа является определение с учетом технологических ограничений режима работы сети магистрального газопровода, обеспечивающего максимальное значение критерия оптимизации и удовлетворяющего заданным граничным условиям на входах и выходах сети.
     Критерием оптимизации может быть:
 Необходимость первоочередного устранения причин, которые могут создавать пожарную и взрывоопасность 
 Выполнение договоров поставок
 Максимум производительности (сумма расходов газа на входах);
 Минимум расхода газа на собственные нужды;
 Максимум прибыли (Стоимость проданного газа - стоимость купленного газа - стоимость расхода газа на собственные нужды);
 Минимум расхода на мероприятия по подержанию баланса, в том числе на компенсацию расчетно-методической погрешности запаса газа в МГ. 
Математическая модель системы управления балансом
Моделирование стационарных режимов управления балансом газа осуществляется на основе предположения о его прямой зависимости небаланса от объемов влияния факторов-причин его возникновения ? и обратной зависимости от объемов, направленных на его подержание Qподдопт:
					(16)
Установившийся режим поддержания баланса можно описать следующим уравнением:
				(17)
Где F – функция расхода на поддержание баланса.
Динамика системы управления балансом газа определяется изменениями расхода на поддержание баланса и влиянием факторов – причин небаланса, объединенных параметром ?, следствием влияния которых является падение давления в сети и необходимость его корректировать:
 				(18)	
 				(19)	
где A и B – коэффициенты пропорциональности: А - между отклонением величины небаланса от заданной и корректирующим это отклонения давлением; В -  между отклонением, с целью коррекции баланса, величины давления от заданной и значением поддерживающего баланс объема газа
Структура дискретного автомата:
Q = F(x, y, s, F, G)
где x – набор векторов входных переменных, здесь параметров аномалий;
y - набор векторов выходных сигналов, в данной задаче объемов небаланса;
s - набор состояний автомата, набор факторов-причин, вследствие влияния которых возникли аномалии;
F - функция переходов, мероприятия по поддержанию баланса: 
st+1 = F (st, x) 						
t – момент времени, в который осуществляется переход.
Согласно регламентов и результатов опроса экспертов газовой области, для устранения аномалий осуществляются следующие мероприятия, представленные ниже в обобщённом виде:
 Компенсация за счет расчетно-методической погрешности вычисления запаса газа в магистральном газопроводе;
 Плановая поверка средств измерений;
 Внеплановая поверка средств измерений;
 Проверка действий оператора по подаче давления потребителям;
 Проверка и, при необходимости, корректировка расчетов с потребителями;
 Плановая проверка обходчиком наличия свища или микротрещины;
 Внеплановая проверка обходчиком наличия крупной утечки;  
 Подача корректирующего давления Pкорр.
 Направление бригады на устранение крупной утечки;   
 Направление комиссии (на проверку попадания в газ влаги или кислорода, наличие врезок).
 Применение уставок, прекращение поставок. 
G - функция выходов, условия оптимизации, согласно которым принимается решение в пользу того или иного мероприятия по корректировке: 
yt = G (st, x)
Набор условий оптимизации приведен на стр.9.: 


1

